@Library ('vishant-library@master') _
node {

    def scmVars = checkout([
               $class : 'GitSCM',
               branches : [[name: '*/master']],
               doGenerateSubmoduleConfigurations: false,
               extensions : [/*[$class: 'CleanBeforeCheckout']*/],
               submoduleCfg : [],
               userRemoteConfigs: [[credentialsId: 'bitbucket-access', url: 'git@bitbucket.org:noon-wallet-engineering/load-money-service.git']]
           ])


properties(
    dildo.call()
)

    stage('test') {
        println 'some text'
        println scmVars.GIT_BRANCH
    }
    stage('check user'){
        checkUser()
    }

    stage('service name') {
        helmSvcName.call()
    }

    stage('Current Image Tag'){
        currentImageTag.call()
    }

    stage('Fetching Source Code'){
        fetchCode.call()
    }

    stage('Let\'s Build') {
        build.call()
    }

    stage('Build Docker Image') {
        dockerCMD.call()
    }

    stage('Finally Let\'s deploy service to k8s Cluster'){
        deploy.call()
    }

    stage('Pod Status') {
        podStatus.call()
    }
}
